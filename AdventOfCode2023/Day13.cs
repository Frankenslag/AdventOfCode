
namespace AdventOfCode2023
{
    internal class Day13
    {
        private static readonly string[] DataProd =
        [
            ".####.#...##.#.",
            "...###.##.#.#..",
            "...###.##.#.#..",
            ".####.#...#..#.",
            "..##......#..#.",
            "#.#...#.##...##",
            ".#.#.#..##..##.",
            "#..##...#####.#",
            ".#.#.#.#..##.#.",
            ".....###.#.#..#",
            ".....###.#.#..#",
            "",
            ".#.###.....",
            "#..#.##...#",
            ".#.....#.#.",
            ".#.....#.#.",
            "#..#.##...#",
            ".#.###.....",
            "##.#..##.##",
            "#....##..#.",
            ".##.##.#.##",
            "...#..###.#",
            "...#..###.#",
            ".##.##.#.##",
            "#....##..#.",
            "####..##.##",
            ".#.###.....",
            "#..#.##...#",
            ".#.....#.#.",
            "",
            "###....##....",
            "####..#..#..#",
            "..###.####.##",
            "..#..######..",
            "...#.######.#",
            "#####.#.##.##",
            "##.#..#..#..#",
            "##....####...",
            "....#......#.",
            ".....#.##.#..",
            "##...##..##..",
            "...##.#..#.##",
            "##..###..###.",
            "",
            ".##.#...##.",
            ".#.########",
            ".##.#.#.##.",
            "#.##..#....",
            "####.##....",
            "####.##....",
            "#.##..#....",
            ".##.#.#.##.",
            ".#.########",
            ".##.#...##.",
            "..####.####",
            ".##.###.###",
            ".#..#.#.##.",
            "#.####..##.",
            "...#..#....",
            "",
            ".....##..#.",
            ".##..##.#.#",
            "#..#...####",
            "####.....##",
            "#..#.##....",
            "#####.....#",
            "#####.....#",
            "#..#.##....",
            "####.#...##",
            "#..#...####",
            ".##..##.#.#",
            ".....##..#.",
            "....##.##..",
            "",
            "#####..",
            ".##.#..",
            ".##....",
            ".##...#",
            ".##....",
            "#..####",
            "..#.#.#",
            "#####..",
            "#####.#",
            ".##...#",
            ".##.##.",
            ".##.##.",
            ".##...#",
            "",
            ".##.#.##.##.##.##",
            ".##.####....###..",
            ".##.#.#.#.##..##.",
            "#..#.#..#.#.##.#.",
            "....####...####..",
            "#..##.#...######.",
            "....#.#..........",
            "#..#.##.####..###",
            "#####...##......#",
            "....###..##.##.##",
            "####..###..####..",
            ".##..##..#.####.#",
            "#..##..##..#..#..",
            ".##..#.#.#..##..#",
            "####..####.####.#",
            "####.....###..###",
            "#..#..##.##.##.##",
            "",
            ".#..#.#.#####",
            "#.##.#.#.#.##",
            "#.##.#.#.#.##",
            ".#..#.#.#.###",
            "##..##..###..",
            "##.####.#####",
            ".##.#.#...###",
            "",
            ".###.#.###.###..#",
            "...####.####..#.#",
            "#..####.####..#.#",
            ".###.#.###.###..#",
            "...###..#..##....",
            ".#.#####.###..###",
            "#.#.#####.#.#####",
            ".##.###.#...###..",
            ".##.#.....##..##.",
            "#..##.####...##..",
            "#.#.#..#....#.###",
            "..#...#...##..##.",
            "##..#.######...##",
            "###.#.####..#..##",
            "...#..##..##...##",
            "###....##.#..#..#",
            "###....##.#..#..#",
            "",
            "##.###..####..#",
            "#.###.###.##..#",
            "..##...##..##.#",
            "..##...##..##.#",
            "#.###.###.##..#",
            "##.###..####..#",
            "....#####.#####",
            "##..#....#.#..#",
            "##.#..#.#...#..",
            ".##.#..##.#.###",
            ".##.#..##.#.###",
            "#..#..#.#...#..",
            "##..#....#.#..#",
            "",
            ".###.#....##....#",
            "#.##.##........##",
            "...###.#..##..#.#",
            "...###.#..##..#.#",
            "#.##.##........##",
            ".###.#....##....#",
            ".###..#.##..##.#.",
            ".###.#...####...#",
            "####.....####....",
            "###...##...#..##.",
            ".#..#.#.#.##.#.#.",
            "",
            "#.#..#.",
            "#.#..#.",
            "#......",
            "###..##",
            "##.##.#",
            "..####.",
            "#......",
            "##.....",
            ".##..##",
            "..#..#.",
            "..#..#.",
            ".##..##",
            "...##..",
            "",
            "##.#########..##.",
            "...#.####.#.##..#",
            "##.#...#..##..##.",
            "....#..###.##.#.#",
            "....#..###.##.#.#",
            "##.#...#..#...##.",
            "...#.####.#.##..#",
            "##.#########..##.",
            "##...####...##...",
            "###...##..###.#.#",
            "...#.#..##.#.....",
            ".........#####...",
            "....##..#.#.##.##",
            "...#.#.###.....#.",
            "...##..#.##.#.#.#",
            "##...##....#.####",
            "###....###......#",
            "",
            "..##.##.##......#",
            ".###....###....##",
            "#.###..###.####.#",
            ".##########.##.##",
            "...##..##........",
            "###......###..###",
            ".##########....##",
            ".#.######.#.##.#.",
            ".....##.....##...",
            "####.##.####..###",
            "...#....#........",
            ".##.#..#.##.....#",
            "..##.##.##......#",
            "",
            "####.##",
            ".##..#.",
            "..###.#",
            ".##.#.#",
            "###.#..",
            "##...##",
            "##...##",
            "#####..",
            ".##.#.#",
            "..###.#",
            ".##..#.",
            "####.##",
            "####.##",
            ".##..#.",
            "..###.#",
            "",
            "#.###..",
            ".....##",
            "..#....",
            ".#.##..",
            "..#.###",
            "..#..##",
            ".#.##..",
            "",
            "#..#.###....#####",
            "##.####.####.####",
            "#...###..#..#.##.",
            "..###.#.##.....#.",
            "..#....####..####",
            "...#.###.#.##.##.",
            ".#...###.#..#####",
            ".#.#...##.#......",
            ".##.##..#.....##.",
            ".#..#.#...##.#..#",
            ".#....##.##.##..#",
            "###..####.###....",
            "###..####.###....",
            "",
            "######.#.##....",
            ".####.#..##.##.",
            ".####.##..#....",
            ".####.#.#.#####",
            "#....#..####..#",
            ".####...#.#....",
            "..........##..#",
            "..##..#.#####.#",
            "######.#...####",
            "#.##.##.....##.",
            ".#..#...##.####",
            "..........#####",
            "#.##.#####.#..#",
            "",
            "#####.#",
            "##.##.#",
            "#.#.###",
            "...##.#",
            "######.",
            "......#",
            "......#",
            "######.",
            "...##.#",
            "#.#.###",
            "##.##.#",
            "",
            ".#..#.#####...#..",
            "#######.#.#.....#",
            "#....#...#.#...##",
            "######...###...##",
            ".#..#..###..#..##",
            "#....##..#...##.#",
            ".####..##.###.##.",
            ".#..#.##.###..#..",
            "#....#.#.##.##.#.",
            ".#..#.#...#.##...",
            ".####.##.#.#....#",
            ".......#.##.#.##.",
            ".......#.##.#.#..",
            ".####.##.#.#....#",
            ".#..#.#...#.##...",
            "",
            "##.####",
            "..#....",
            "###....",
            ".##....",
            "#.#....",
            "#.#....",
            "..#....",
            "###.##.",
            "#..####",
            "#.#####",
            "###....",
            "#..####",
            ".######",
            "##.####",
            ".#.....",
            "",
            "###.##....##.##",
            "##.##......##.#",
            "####...##...###",
            "....#.#..#.#...",
            "....#.....##...",
            "#####..##..####",
            "###..##..##..##",
            "###..#.##.#..##",
            "###..#....#..##",
            "#####.####.####",
            "..#.#..##..#.#.",
            "..#..#.##.#..#.",
            "##............#",
            "",
            "###.#.##.#.#.#.",
            "###.#.##.###.#.",
            "##..#...##....#",
            ".#..###.###..##",
            "#.#......###.##",
            "........##.##.#",
            "........##.##.#",
            "#.#......###.##",
            ".#..###.###..##",
            "##..#...##....#",
            "###.#.##.###.#.",
            "###.#.##.#.#.#.",
            ".#..#.#...#.###",
            ".....##.#.##.#.",
            ".#.###.#.###.##",
            ".#.#.....###.#.",
            "##....####.#.##",
            "",
            "###......###.",
            "##.######.###",
            "###.####.###.",
            "##..#..#..##.",
            "..##....##...",
            "###..##..###.",
            "####....#####",
            "####.##.####.",
            "##.##..##.##.",
            "#...####...#.",
            "...#....#....",
            "...#....#....",
            "..#.#..#.#..#",
            "",
            ".##..##.###..##",
            ".##.#...##.#.#.",
            ".##.#...##.#.#.",
            ".##..##.###..##",
            "#...#.#..####..",
            ".#.#....#.#....",
            "#..##..#..##...",
            "##....####..#..",
            ".#.....#.###..#",
            "..#....#.#...#.",
            ".##...#.#..#.##",
            "...##.#..######",
            ".###.......####",
            ".###.......####",
            "...##.#...#####",
            "",
            ".#........#.##.",
            "#.##.#...##.#.#",
            "###.####...##.#",
            "###.####..###.#",
            "#.##.#...##.#.#",
            ".#........#.##.",
            "...#.##.#.#.##.",
            "#.####.###.####",
            ".#...##.##.###.",
            ".....#..#.####.",
            "##.##.##..##..#",
            ".....#..#.....#",
            "##.##.#.#####..",
            "##.##.#.#####..",
            ".....#..#.....#",
            "##.##.##..##..#",
            ".....#..#.####.",
            "",
            "######.##.###",
            ".#..##.##.##.",
            "#.#.##.##.##.",
            "#.#..#.##.#..",
            "....#.####.#.",
            "#...#..##..#.",
            "####.#....#.#",
            ".###.######.#",
            "####.###.##.#",
            "....###..###.",
            "..###.####.##",
            "..###.####.##",
            "....###..###.",
            "",
            "..##..##..#",
            "..###.#....",
            "##....#....",
            "###.#.#.##.",
            "##.####.##.",
            "##...##.##.",
            "...##..####",
            "##.#####...",
            "...#.##....",
            "..#####.##.",
            "...#..##..#",
            "..#.#..####",
            "##.....####",
            "...##.#.##.",
            "..#####.##.",
            ".....#.#..#",
            "##.##...##.",
            "",
            "#......##.##.##",
            "..####..#####..",
            "..#..#...#..#..",
            ".######.##.#...",
            "..#..#....#####",
            "...##....######",
            ".........#.##..",
            ".##..##.#......",
            "####.####.#.###",
            "",
            "#......##......##",
            "..####....####...",
            "..#..#....#..#..#",
            "...##......##....",
            "################.",
            ".#....#..#....#..",
            "...##......##....",
            ".#....#..#....#..",
            "##....####....##.",
            "..#..#....#..#...",
            "..#..#....#..#..#",
            "##.##.####.##.##.",
            "###..######..###.",
            "..####....####...",
            "...##......##....",
            "####.######.#####",
            ".#.##.#..#.##.#.#",
            "",
            "...##.##.##..",
            "##..........#",
            "##..##..##..#",
            "..#.######.#.",
            "##...####...#",
            "...##.##.##..",
            "###..####..##",
            "##...####...#",
            "...##.#..##..",
            "....##..##...",
            "##..#.##.#..#",
            "",
            ".#.##.####.##.#..",
            "##..###..###..##.",
            "##..##....##..##.",
            "#.#.##....##.#.#.",
            "#.#.###..###.#.#.",
            "##...##..##...###",
            "#..#.##..##.#..##",
            "....#.#..#.#....#",
            "....#.#..#.#.....",
            "",
            ".##.#.....#...###",
            "###..#.####..####",
            "##....#..####....",
            "#..###..#.#..####",
            "..#.####.####.##.",
            ".##....##...#.##.",
            ".##....##...#.##.",
            "..#.####.####.##.",
            "#..###..#.#..####",
            "##....#..####....",
            "###..#.####..####",
            "",
            "##..#.#..#.#.",
            "##.###.##.###",
            "#######..####",
            "##..##....##.",
            "##.####..####",
            "#####..###.##",
            "####...##...#",
            "....###..###.",
            "..##..#..#..#",
            "..#..##..##..",
            "##.##.#..#.##",
            "###.###..###.",
            "...##.####.##",
            "##.###.##.###",
            "...#...##...#",
            "..#....##....",
            ".....#....#..",
            "",
            "..#.##.##",
            "..#..####",
            "#...#.##.",
            "#...#.##.",
            "..#..####",
            "..#.##.##",
            "######...",
            "#.##..#..",
            ".#.....#.",
            "###.###.#",
            "#.##..###",
            ".#..#..#.",
            "###.##...",
            "###..#...",
            "###..#...",
            "###..#...",
            ".#..#..#.",
            "",
            "###.###.##.",
            "###.###.##.",
            "##.#.##..#.",
            "....#.##.##",
            ".#.##.##.##",
            "###....####",
            "###.##..#..",
            "",
            "####.#..##..#.#",
            ".......######.#",
            "####.##.....#..",
            "####.##.....#..",
            ".......######.#",
            "####.#..##..#.#",
            ".##.####.#.#.#.",
            "######....#.#.#",
            ".......#....#..",
            "###...###.#####",
            "#..#..#####.###",
            "......##.##.#..",
            ".##.###.###...#",
            "####...###.####",
            "#####.###...#.#",
            "",
            "#####....",
            "#...#####",
            "#....####",
            "#..##..##",
            "#..##..##",
            "#....#.##",
            "#...#####",
            "#####....",
            "#..#..#..",
            ".#....###",
            "##.#..#..",
            ".#...####",
            "###.#.###",
            "##.#.....",
            "##...#.##",
            "",
            "....#.#.#......",
            ".....#.#####...",
            "....###..#.#...",
            "..#...#..##.###",
            "####...##..####",
            ".##...##.###.##",
            "#..#..#........",
            "#..###..##.....",
            ".....####...#..",
            ".##.#.#.###.###",
            "####.##.#.#.###",
            ".....#.#.....##",
            "########...####",
            "#..###..###..##",
            ".##.###.#..####",
            "",
            ".#.#..##.#.#.#.",
            "....##.....##..",
            "#.#.####..####.",
            "#..#..##.###...",
            "#..#..##.###...",
            "#.#.####.#####.",
            "....##.....##..",
            ".#.#..##.#.#.#.",
            ".#####..#..####",
            "#....#.#..##..#",
            "#..#.#..##.#..#",
            "#.##..#..#.#..#",
            ".####..##.#..#.",
            ".####..##.#..#.",
            "#.##..#..#.#..#",
            "#..#.#..##.#..#",
            "#....#.#..##..#",
            "",
            "#..#######..#.#..",
            "#.#...#.###..####",
            "##....###.###.###",
            ".........#.#.....",
            ".#.#..####...##..",
            "#.#.##.#.###...##",
            "#.#.#...####.....",
            "#.#.#...####.....",
            "#.#.##.#.###...##",
            ".#.#..####...#...",
            ".........#.#.....",
            "##....###.###.###",
            "#.#...#.###..####",
            "#..#######..#.#..",
            "##...#.####....##",
            "",
            "....######.",
            "###.....#.#",
            "###.....#.#",
            ".#..######.",
            ".#..######.",
            "###.....#.#",
            "###.....#.#",
            "....######.",
            ".#####.###.",
            "#..#......#",
            "##....##.##",
            ".#.#.#..#.#",
            ".####....##",
            "##...#.#.#.",
            "#...###..#.",
            "",
            "########..###",
            "....###....##",
            "....###.##.##",
            "####.........",
            "....####..###",
            "#..##..####..",
            "######.####.#",
            "#..#...#..#..",
            "####...####..",
            ".##.....##..#",
            "#..##########",
            "#..#..######.",
            ".##.#..#..#..",
            "",
            "#.##.####.#....",
            "#.##.####.#....",
            "##...##.##..###",
            "..#..#...#.#..#",
            "#.#....#.##...#",
            ".#.####.#...#.#",
            "####.#.#....###",
            ".##.#.####...##",
            ".##.#.####...##",
            "####.#.#.#..###",
            ".#.####.#...#.#",
            "#.#....#.##...#",
            "..#..#...#.#..#",
            "##...##.##..###",
            "#.##.####.#....",
            "",
            "###..##",
            "###..##",
            "#..##.#",
            ".##....",
            ".##....",
            "#..##.#",
            "####.##",
            "",
            "....#...#..#.",
            ".##..#..#.#.#",
            "####.##.##.#.",
            "###.###..#...",
            "#.#.#...###.#",
            "#.#.#...###.#",
            "###.###..#...",
            "####.##.##.#.",
            ".##..#..#.#.#",
            "....#...#.##.",
            "#.###.##.##.#",
            "#.###.##.##.#",
            "....#...#.##.",
            ".##..#..#.#.#",
            "####.##.##.#.",
            "",
            "..#..#........#",
            "...##....#.#...",
            "##....###...#.#",
            "##....##.###.#.",
            "...##...#.#.#..",
            "........#######",
            "##....##.#.....",
            "..............#",
            "#########.##.#.",
            "........#.#.##.",
            "#########..##..",
            ".######..##..#.",
            "..####..###..#.",
            "..####.....#...",
            "..####...##....",
            "",
            "..#####.###",
            "...####.###",
            ".....#.#...",
            ".####..##.#",
            "##...#..###",
            "##...#..###",
            ".####..##.#",
            "",
            "#..##.###.####.##",
            "########.##..##.#",
            ".##....##.####.##",
            "#######.#......#.",
            "####..##...#....#",
            "####..###########",
            "....#############",
            "......##.##..##.#",
            "#######..##..##..",
            "#..##.#...#..#...",
            ".##.#.##.##..##.#",
            ".##..###..#..#..#",
            "....#.##........#",
            ".....##.#.####.#.",
            ".##.#.##........#",
            "",
            ".##....#...#.#...",
            ".##....#...#.#...",
            "..#...###.#####..",
            ".####...#..#..##.",
            "##.###.#.....##..",
            ".....##.#..#.#.##",
            ".#.##....##.#.#..",
            "#..........####..",
            "#.....###.##...##",
            "",
            "#.###..##..",
            ".#..#.#..##",
            "###..##....",
            "###..##....",
            ".#..#.#.###",
            "#.###..##..",
            "####.#..###",
            "",
            ".....#.####..#..#",
            ".....#.####..#..#",
            "..#.#..###.#..#.#",
            "####..#####.##...",
            "..#.##..###.....#",
            "##...#.###.#..#.#",
            "###.#.#...#...###",
            ".###.....#.##..#.",
            ".###....##.##..#.",
            "",
            "...#...#..#.##..#",
            "#..##.#..####.##.",
            ".##..#.#..##..##.",
            "..##..###....#..#",
            ".#.....###.#.####",
            "###..#.#.##...##.",
            "###..#.####...##.",
            "",
            "##.##..",
            "..#....",
            ".#.#...",
            "##.####",
            "##.####",
            "...#...",
            "..#....",
            "##.##..",
            "#.#####",
            "##..#..",
            ".#.#...",
            "..#.#..",
            "###.###",
            "....###",
            ".##.#..",
            "#..#.##",
            "##...##",
            "",
            "###.#....#.##",
            "#..#.#..#.#..",
            "#..#.#..#.#..",
            "###.#....#.##",
            "#.###....###.",
            ".##...#....##",
            "...#.####.#..",
            "##..##..##..#",
            "..#..####..#.",
            ".##..####..##",
            "##..#....#..#",
            "..##.#..#.##.",
            ".##.#....#.##",
            "",
            "..#######",
            "...##.##.",
            "##.#.####",
            "#.#..#..#",
            ".#.##....",
            "#.##.#..#",
            "...######",
            "#..######",
            "#.##.#..#",
            "",
            "######.........",
            ".##..##..##..##",
            ".......##..##..",
            ".#.#...#.##..##",
            "#.#.##...#....#",
            ".##..#.....##..",
            ".##..#.....##..",
            "#.#.##...#....#",
            ".###...#.##..##",
            "",
            "####..#.##.#.",
            "###.#.#.##.#.",
            "#.##..#.##.#.",
            "....#..#..#..",
            ".#.###.####.#",
            "##..#.######.",
            ".#.##.#.##.#.",
            "#.##..######.",
            "#.##..######.",
            ".#.##.#.##.#.",
            "##..#.######.",
            ".#.###.####.#",
            "....#..#..#..",
            "#.##..#.##.#.",
            "#.#.#.#.##.#.",
            "####..#.##.#.",
            ".#..#.#.##.#.",
            "",
            ".#........#..",
            "#.###..###.##",
            ".#..####..#..",
            "#.#.#..#.#.##",
            ".#.#.##.#.#..",
            ".##..##..##..",
            "#...####...##",
            "..#.#..#.#...",
            "...#.##.#....",
            "#..#....#..#.",
            "..#.####.#...",
            ".##########..",
            ".#........#..",
            "#..#....#..##",
            "..##....##...",
            "",
            ".##..###...#...",
            ".##.##.########",
            "#.#.#..#..#..#.",
            ".#......###..##",
            "....######.##.#",
            ".#.##......##..",
            "##.#...###.##.#",
            "##.#...###.##.#",
            ".#.##......##..",
            "....######.##.#",
            ".#......###..##",
            "",
            ".##...##.",
            "#..#.###.",
            "####.....",
            "#..######",
            ".##..#..#",
            ".##.#####",
            "....#####",
            "",
            ".###...#####.###.",
            "..##...#..##..##.",
            "..##..#..#...#..#",
            "##..###.#.#.#.##.",
            "##..##.#.#......#",
            "##..###...##.###.",
            "........##.###..#",
            ".####.#....###..#",
            "#.##.###..#..###.",
            ".........#.#.#..#",
            "##..##.#.##..###.",
            "##..##.#.##..###.",
            ".........#.#.#..#",
            "",
            "....#......#...",
            "....###..###...",
            ".....######....",
            "##.#.#....#.#.#",
            "##.....##.....#",
            "..##..#..#..##.",
            "..####....###..",
            "",
            ".....#.#..#",
            "#####.#####",
            "#..########",
            "#..#.######",
            "#....#..##.",
            ".##.#..#..#",
            "#..#..#####",
            "",
            "#.##.#..#",
            "##..#.##.",
            "..###.##.",
            "..#...##.",
            "#.#...##.",
            "###......",
            "###......",
            "#.#...##.",
            ".##...##.",
            "",
            ".......#.",
            ".......#.",
            ".#..#.#..",
            ".####...#",
            "..##..#.#",
            "########.",
            ".####.#.#",
            "..##.....",
            "..##...#.",
            "#....#..#",
            "##..##.##",
            "######...",
            ".#..#.#.#",
            "#.##.###.",
            "#.##.##..",
            "....#...#",
            "######.##",
            "",
            "#..#..#........#.",
            "....##..#.##.#..#",
            "....##.#..##..#.#",
            ".....#...#..#...#",
            "####..#.##..##.#.",
            ".##.#####....####",
            "....#.#.##..##.#.",
            "...######....####",
            "######..##..##..#",
            "",
            "###.#..",
            "####..#",
            "..#....",
            "###.##.",
            "...#..#",
            "..#.##.",
            "###.##.",
            "###....",
            "..#.##.",
            "",
            ".#..###....#...",
            "##...#...###...",
            ".#..#..##...#.#",
            ".#..#..##...#.#",
            "##...#....##...",
            ".#..###....#...",
            "###..###..#.#.#",
            "#.##.#.#.#####.",
            "#......##...#.#",
            "###....#.#.#.#.",
            "###....#.#.#.#.",
            "#......##...#.#",
            "#.##.#.#.#####.",
            "###..###..#.#.#",
            ".#..###....#...",
            "##...#....##...",
            ".#..#..##...#.#",
            "",
            "..##.#.",
            "##.##..",
            "..##.#.",
            "...##.#",
            "#.#####",
            "..###.#",
            "..#.##.",
            "###.###",
            "##...#.",
            "..####.",
            "..####.",
            "##...#.",
            "###.###",
            "",
            ".##.#...#.##.",
            "#.####.####.#",
            "####...#.#..#",
            ".##.#.######.",
            "######...##.#",
            ".....#..#.#..",
            ".....#..#.#..",
            "######...##.#",
            ".##.#.######.",
            "",
            ".###.#.#.",
            "...#.##..",
            "##.....##",
            "###..#.#.",
            "#.#..##..",
            "...#..##.",
            ".......#.",
            ".......#.",
            "...##.##.",
            "...##.##.",
            ".......#.",
            ".......#.",
            "...#..##.",
            "",
            "...##....####.##.",
            ".##..###.#...####",
            "###..###.####.##.",
            ".######.#....####",
            "########....#.##.",
            "..#..#..##..#....",
            ".##..##...#......",
            "..#..#..##.###..#",
            "#.####.##.#......",
            "",
            "#.#..#####..#..",
            "##.##.####..###",
            "#......#.##.#.#",
            "###..####.##...",
            "#.#..#.###...#.",
            ".#.##.#.#.#.###",
            "##.##.##..#.###",
            ".##..##.#####..",
            "#......#.##....",
            "#......#.##....",
            ".##..##.#####..",
            "##.##.##..#.###",
            ".#.##.#.#.#.###",
            "#.#..#.###...#.",
            "###..####.##...",
            "#......#.##.#.#",
            "##.##.####..###",
            "",
            "####..#####",
            ".....#..###",
            "#..####.#..",
            ".......##..",
            "#..#..#.###",
            "####.......",
            ".....#.#.##",
            "#..##..#...",
            ".##...##..#",
            ".......###.",
            ".##..##..##",
            "....#....##",
            "####.#.##.#",
            "#####.####.",
            "#####.###..",
            "",
            "#..#.####.#.#..",
            "#.#####.#.#####",
            "##.#...##.#...#",
            "#..#.##...#.##.",
            "#..#.##...#.##.",
            "##.#...##.#...#",
            "#.#####.#.#####",
            "#..#.####.#.#..",
            "#..#.######.###",
            ".....####....##",
            ".##.....##.####",
            "......#.##..##.",
            "......#.##..##.",
            ".##.....##.####",
            ".....####.....#",
            "#..#.######.###",
            "#..#.####.#.#..",
            "",
            "#.#...###",
            "#.#####..",
            ".###.....",
            ".###.....",
            "#.#####..",
            "#.#...###",
            ".#.....#.",
            ".#..###.#",
            ".#..###.#",
            ".#.....#.",
            "#.#...###",
            "#.#####..",
            ".#.#.....",
            "",
            "..........###",
            "..##....#.###",
            "..##....#..##",
            "..........###",
            ".####...#....",
            ".####.######.",
            "##..##.######",
            ".####.....##.",
            ".####.##.###.",
            "",
            "######..##.",
            ".#..#..#..#",
            "#######.##.",
            "######..##.",
            ".####.##..#",
            ".####.#....",
            ".####...##.",
            ".#..#.#####",
            "##..#######",
            ".####.#....",
            "#.##.##....",
            "..##....##.",
            ".#..#.#####",
            "##..##..##.",
            ".####...##.",
            "#.##.##..#.",
            "#....###..#",
            "",
            "#...#..#....#.##.",
            "..........###.##.",
            "....#.#.###..#..#",
            ".###...######.##.",
            ".###....#####.##.",
            "....#.#.###..#..#",
            "..........###.##.",
            "#...#..#....#.##.",
            "##.###.###...####",
            "#......#...#.#..#",
            "..#..##..........",
            ".###.###.##...##.",
            "..##.#####..#####",
            "....#.##.#.##....",
            "....##.#..#.##..#",
            "...#####....##..#",
            "....#.###..#.####",
            "",
            "...######...#",
            "##.##..##.##.",
            "##.#....#.###",
            "####.##.#####",
            "#..........##",
            "....#........",
            ".####..####.#",
            ".#.##..##.#..",
            "#....##....##",
            "#..........##",
            "....####.....",
            "##.##..##.###",
            "##.##..##.###",
            "",
            "###..##",
            "##.#.#.",
            "..#...#",
            "##..#..",
            "#####.#",
            "###..#.",
            "###....",
            "",
            "#####.#",
            "...####",
            ".##....",
            "...#..#",
            "#.#....",
            ".######",
            "###....",
            "###....",
            ".######",
            "",
            "..#..####..",
            "####.####.#",
            "####.####.#",
            "..#...###..",
            "##...#.#.#.",
            "...####...#",
            "....#...##.",
            "..#.###.#.#",
            "#######.##.",
            "...#...##.#",
            "..#.#.#...#",
            "####.#....#",
            ".....#..#.#",
            "",
            "######..#",
            "..##...#.",
            "##..##.#.",
            "#....###.",
            "#....##..",
            "##..##.#.",
            "..##...#.",
            "",
            "#.##..#",
            "#####..",
            "##.##..",
            "##.##..",
            "#####..",
            "#.##..#",
            ".###.##",
            ".#.##..",
            ".###.##",
            ".##..##",
            "#.#.###",
            ".#.....",
            "##.##..",
            ".######",
            ".#.####",
            "",
            "####..#..#..###",
            "..#.########.#.",
            "####...##...###",
            "...##########..",
            "..#..........#.",
            "###.########.##",
            "..#..##..##..#.",
            "##..#.####.#..#",
            "##.#.##..##.#.#",
            "###.###..###.##",
            "####.##..##.###",
            "..#....###...#.",
            "..##.#....#.##.",
            "##..##.##.##..#",
            "...##########..",
            "######.##.#####",
            "###..........##",
            "",
            "#.....#...#..#...",
            "##.#...#..#..#..#",
            "##.###.##########",
            "##.##.###########",
            "#.##...#.#.##.#.#",
            "#.#..............",
            "..##.....##..##..",
            "##..#......##....",
            "##.##.#.#.####.#.",
            "##..#.#.#.####.#.",
            "##..#......##....",
            "",
            "......#.##.#...",
            "#.##.#......#.#",
            "......####.#...",
            ".#..#.#....#.#.",
            "##..###.##.###.",
            ".#..#.#....#.#.",
            "#....##....##..",
            ".####..####..##",
            ".####.#....#.##",
            "",
            "#####.#.##.#.",
            "...##...##.#.",
            "...##...##.#.",
            "#####.####.#.",
            "####...#....#",
            "####.....###.",
            "##....###.##.",
            "##...##...###",
            "..###...##.#.",
            ".....#.#.##..",
            "...#.##......",
            "####..#####..",
            "###.#....##..",
            "..######..###",
            "....##...#..#",
            "",
            ".##.###....####",
            "#......#..#####",
            "..#..#..#.##..#",
            "#...##.####....",
            ".###...####....",
            ".###...####....",
            "#...##.####....",
            "..#..#..#.##..#",
            "#.....##..#####",
            "",
            "#..##..#.#.#..#",
            "....#.#.##.##.#",
            "....#.#.#.####.",
            "####.#.....##.#",
            ".##...#.#..###.",
            ".##...#.#..###.",
            "####.#.....##.#",
            "....#.#.#.####.",
            "....#.#.#..##.#",
            "#..##..#.#.#..#",
            "####.#...##.#.#",
            "#####..#.###..#",
            ".....#.#.#.##..",
            "#..##.##.###.#.",
            "#..#...##.#.#.#",
            "....##.###.#..#",
            ".##.###.....##.",
            "",
            ".#..#.##.####..##",
            "#..##..#.#.#...##",
            "#...#.#.##.#.##.#",
            "##..###....#.###.",
            ".###...#.#.####.#",
            ".###...#.#.####.#",
            "##..##.....#.###.",
            "#...#.#.##.#.##.#",
            "#..##..#.#.#...##",
            ".#..#.##.####..##",
            ".#....###..##...#",
            "#.#.######..#####",
            "...#.#..##...####",
            ".#.#####.....##..",
            "##.#.#.##.###....",
            "##.#.#.##.###....",
            ".#.#####.....##..",
            "",
            ".#..#.#.#.##.",
            "##..##.#.....",
            "#....#.#.####",
            "#.##.#.#..##.",
            "..##..#......",
            "##..##.##.##.",
            "#....#.#..##.",
            "######..#####",
            "..##....##..#",
            "#.##.#..##..#",
            ".........####",
            "..##..#.##..#",
            ".#..#..##....",
            "....#...#####",
            "##..##..#.##.",
            ".####.####..#",
            "##..##.######",
            "",
            "#....#..#",
            "###..#...",
            "##.######",
            "..##..#.#",
            "..####.##",
            "##...####",
            "##.#..###",
            ".....#.#.",
            "..##...#.",
            "...#.###.",
            "####..###",
            "......###",
            "...#....#",
            "#####.#.#",
            "..#.#..#.",
            "..#.#..#.",
            "#####.#.#",
            "",
            "#######...#....#.",
            "###.#..##..#..#..",
            "#.###.#..#..##..#",
            "#.###.#..#..##..#",
            "###.#..##..#..#..",
            "#######...#....#.",
            "#...#.#.##.####.#",
            "..#.#.#.##.#..###",
            "#.#...#.###....##",
            ".######.....##...",
            "#..#.#.##.##..##.",
            ".##..#.##.#....#.",
            "#.##..######..###",
            "#...#.#..########",
            "#.###.#..........",
            "",
            "#..#..#..##..#..#",
            "#.###############",
            "####..##....##..#",
            "##.####......####",
            "..#####..##..####",
            "#.##..#..##..#..#",
            "###.####.##.####.",
            "##.#..#......#..#",
            ".###..#.#..#.#..#",
            ".#.#..#..##..#..#",
            "##.####......####",
            ".##.##.#.##.#.##.",
            ".######.####.####",
            "",
            "#.#....#.",
            "###..#..#",
            "###..#..#",
            "#.#....#.",
            ".####..#.",
            "..##..###",
            "..#.#..#.",
            "#..#..##.",
            ".###.###.",
            "...#..#..",
            "...#....#",
            "###.#.###",
            "....#.#.#",
            "##.#.##.#",
            "##.####.#",
            "#..####.#",
            "##.#.##.#",
            "",
            "......#",
            "#####.#",
            "......#",
            "####.#.",
            ".##...#",
            "#..#.#.",
            ".###.##",
            ".....#.",
            ".##....",
            ".##....",
            ".....#.",
            "",
            "...###.#.....##..",
            "#.######.#.......",
            "#.##.###.#.......",
            "...###.#.....##..",
            ".#..##..#.###..##",
            "#..###.####...###",
            "#####.#...#.##...",
            "#####.#..###.####",
            "#########.#.#####",
            ".#####....##..###",
            "##.#..#..####..##"
        ];

        public static long AnalyseTerrain(Dictionary<(int col, int row), char> terrain, int hammingDistance)
        {
            long AnalyseTerrainColOrRow(bool analyseRow)
            {
                char[] GetRowCol(int rowcol, bool getrow) =>
                    terrain.Keys.Where(t => (t.col == rowcol && !getrow) || (t.row == rowcol && getrow)).OrderBy(t => getrow ? t.row : t.col).Select(t => terrain[(t.col, t.row)]).ToArray();

                long retval = 0;

                int dimensionLength = terrain.Keys.Max(t => analyseRow ? t.row : t.col) + 1;

                int gap = 0;

                while (gap < dimensionLength - 1)
                {
                    if (Enumerable.Range(0, Math.Min(gap + 1, dimensionLength - gap - 1)).Select(i => GetRowCol(gap - i, analyseRow).Zip(GetRowCol(gap + 1 + i, analyseRow), (x, y) => x == y).Count(b => !b)).Sum() == hammingDistance)
                    {
                        retval = gap + 1;
                    }

                    gap++;
                }

                return retval;
            }

            return AnalyseTerrainColOrRow(false) + 100 * AnalyseTerrainColOrRow(true);
        }

        public static void Run()
        {
            string[] data = DataProd;

            List<Dictionary<(int col, int row), char>> terrains = data.Aggregate(new List<List<string>>([[]]), (curr, next) =>
            {
                if (string.IsNullOrEmpty(next))
                {
                    curr.Add([]);
                }
                else
                {
                    curr.Last().Add(next);
                }

                return curr;
            }).Aggregate(new List<Dictionary<(int col, int row), char>>(), (patterns, patternlist) =>
            {
                patterns.Add(patternlist.SelectMany((line, row) => line.ToCharArray().Select((c, col) => (col, row, c))).ToDictionary(t => (t.col, t.row), t => t.c));
                return patterns;
            });

            for (int part = 0; part < 2; part++)
            {
                Console.WriteLine($"Day 13 Part {part + 1} Answer is {terrains.Sum(t=> AnalyseTerrain(t, part))}.");
            }
        }
    }
}
